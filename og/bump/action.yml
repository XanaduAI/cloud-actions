name: bump
description: |
  Automatically bump the version file of the OG repo

inputs:
  base_branch:
    description: The base branch of the PR.
    required: true
  pr_body:
    description: OG formatted body of the PR description.
    required: true
  pr_title:
    description: SC formatted title of the PR.
    required: true
  pr_number:
    description: PR serial number
    required: true
  github_repository:
    descripton: Github repository 
    required: true
  openai_api_key:
    description: OPENAI API Key
    required: true  
  dev_branch:
    description: The dev branch of this action to connect to the workflow
    required: false
    default: 'main'

env:
  BASE_BRANCH: ${{ inputs.base_branch }}
  OPENAI_API_KEY: ${{ inputs.openai_api_key }}
  PR_NUMBER: ${{ inputs.pr_number }}
  GITHUB_REPOSITORY: ${{ inputs.github_repository }}

runs:
  using: "composite"

  steps:
    - run: python3 -m pip install semver
      shell: bash
      
    - run: |
        cat << \EOF | tee /tmp/pr_body
          ${{ inputs.pr_body }}
        EOF
        cat << \EOF | tee /tmp/pr_title
          ${{ inputs.pr_title }}
        EOF
        python -c "$(wget -qSO- https://raw.githubusercontent.com/XanaduAI/cloud-actions/${{ inputs.dev_branch }}/og/bump/tagger.py 2>/dev/null)" 
      shell: bash
